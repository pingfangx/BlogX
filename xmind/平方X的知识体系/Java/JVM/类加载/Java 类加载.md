Q:
* 类加载的过程

R:
* 《Java语言规范》12.1
* 《Java虚拟机规范》第5章
* 《Thinking in Java》14.2

S: Java 虚拟机加载类时分三个步骤。
* 加载
* 链接
* 初始化

以下是 JLS 阅读的整理，在 JVMS 中有更详细的介绍。

# 加载
使用类加载器尝试查找并加载类的二进行制表示

## Q: 什么时候会需要加载？什么时候不会？
Thinking 中介绍
> 所有的类都是在对其第一次使用时，动态加载到 JVM 中的。
> 当程序创建第一个对类的静态成员的引用时，就会加载这个类。
> 这个证明构造器也是类的静态方法，即使在构造器之前并没有使用 static 关键字。

在 JVMS 中有更详细的介绍。


# 链接
加载类以后，对类进行校验、准备和可选地解析。

校验会检查被加载的类是否格式良好、具有正确的符号表、遵循 Java 编程语言和 Java 虚拟机的语义要求。

准备涉及静态存储的内存分配，以及虚拟机的实现内部要使用的数据结构的内存分配。

解析是检查类对其他类或接口的符号引用，可以在链接步骤中解析，也可以延迟到只有在符号引用被实际使用时再解析它。

JLS 介绍，准备包括创建类或接口的 static 域（类变量和类常量）和将这些域初始化为缺省值。
但是静态域的显示初始化器会作为初始化过程的一部分而执行，不属于准备过程。


# 初始化
类变量初始化器和静态初始化器按行文顺序执行。

如果有父类，则父类需要先初始化，如果父类还没有初始化过，父类也需要先加载、链接然后初始化。

这里类变量（静态字段）是 static 的字段，而静态初始化器（应该）是指 static 的静态初始化块

最后再调用方法

## 惰性初始化
Thinking 中介绍
> 初始化被延迟到了静态方法（构造器隐式地是静态的）或者非常数静态域首次引用时才执行

所以 .class 不会触发初始化（但是 Class.ForName() 会），常量不会触发初始化（但是非编译期常量就会）

同时时 JLS 12.4.1 也介绍了初始化发生的时机。