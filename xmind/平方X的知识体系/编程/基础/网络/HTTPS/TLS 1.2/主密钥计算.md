# PRF
在第 5 节中介绍
> 该伪随机函数 (pseudorandom function) (PRF)将机密，种子和标识标签作为输入，并产生任意长度的输出。

    PRF(secret, label, seed) = P_<hash>(secret, label + seed)
    P_hash(secret, seed) = HMAC_hash(secret, A(1) + seed) +
                         HMAC_hash(secret, A(2) + seed) +
                         HMAC_hash(secret, A(3) + seed) + ...
    A() 定义为：

      A(0) = seed
      A(i) = HMAC_hash(secret, A(i-1)) 
      
# 记录协议的密钥计算
在 rfc 5246 第 6.3 节中介绍

> 主密钥 (master secret) 被扩展为一系列安全字节，然后将其拆分为客户端写入 MAC 密钥，服务器写入 MAC 密钥，客户端写入加密密钥和服务器写入加密密钥。这些中的每一个都是按照该顺序从字节序列生成的。未使用的值为空。一些 AEAD 加密可能还需要客户端写入 IV 和服务器写入 IV(参见第 6.2.3.3 节)。

   要生成密钥材料，进行计算

      key_block = PRF(SecurityParameters.master_secret,
                      "key expansion",
                      SecurityParameters.server_random +
                      SecurityParameters.client_random);

   直到产生足够的输出。然后，key_block 按如下方式分区：
   

      client_write_MAC_key[SecurityParameters.mac_key_length]
      server_write_MAC_key[SecurityParameters.mac_key_length]
      client_write_key[SecurityParameters.enc_key_length]
      server_write_key[SecurityParameters.enc_key_length]
      client_write_IV[SecurityParameters.fixed_iv_length]
      server_write_IV[SecurityParameters.fixed_iv_length]

 
## 小结
* 将 master_secret 扩展为特定长度的安全字节
* 将安全字节拆分为各密钥
* 扩展使用的是 PRF 函数  
该函数需要 secret,label,seed
对应 master_secret, "key expansio", server_random+client_random


# 密钥计算
在第 8 节中介绍，  
需要使用 pre_master_secret 计算 master_secret

pre_master_secret 在客户端密钥交换消息中发送，在 7.4.7 节中介绍。