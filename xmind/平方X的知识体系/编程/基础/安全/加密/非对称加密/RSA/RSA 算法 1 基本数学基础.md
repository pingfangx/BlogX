[RSA加密算法](https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95)  
> RSA就是他们三人姓氏开头字母拼在一起组成的。


[RSA算法原理（一）](http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html)  

# 用公钥加密，用私钥解密

# 1 数学基础
## 互质关系
> 如果两个正整数，除了1以外，没有其他公因子，我们就称这两个数是互质关系（coprime）。比如，15和32没有公因子，所以它们是互质关系。这说明，不是质数也可以构成互质关系。

## 1.1 欧拉函数
### 情况一
如果n=1，则 φ(1) = 1 

### 情况二
如果 n 是质数，则 φ(n)=n-1  
n 与小于它的数都构成互质关系  

### 情况三
如果 n 是质数的某一个次方，即 n = p^k (p为质数，k为大于等于1的整数)，则  
φ(n) = p^k - p^(k-1)
        =p^k×(1-1/p)

如果一个数是 p 的倍数，就不与 p^k 互质。  
这些数有 1×p、2×p、3×p...p^(k-1)×p  
所以共有 p^(k-1) 个不互质，去掉即为互质的。

    比如
    8=2^3
    φ(8) = φ(2^3) =2^3 - 2^2 = 8 -4 = 4
    
    去掉的数为 2,4,6,8
    
### 情况四
    积的欧拉函数等于各个因子的欧拉函数之积
    如果 n = p1 × p2  
    则 φ(n) = φ(p1p2) = φ(p1)φ(p2)

### 情况五

## 1.2 欧拉定理
如果 a 与 n 互质，则  
    a^(φ(n)) ≡ 1(mod n)

    ≡ 表示同余
    即 a^(φ(n)) 对 n 的求余，与 1 对 n 求余（得 1） 相等
    a 的 φ(n) 对 n 求余得 1

根据情况二，有
    
    费马小定理
    假设正整数a与质数p互质，因为质数p的φ(p)等于p-1，则欧拉定理可以写成
    a^(p-1) ≡ 1(mod p)
    
    
## 1.3 模反元素
    如果两个正整数a和n互质，那么一定可以找到整数b，使得 ab-1 被n整除，或者说ab被n除的余数是1。
    ab ≡ 1(mod n)
    比如，3 和 11 互质，可以找到模反元素 4。
    3 × 4 - 1 可以被 11 整除。
    b+kn 都是 a 的模反元素。
    
    根据欧拉定理证明模反元素必然存在。
    a^(φ(n)) ≡ 1(mod n)
    a^(φ(n)) = a × a^(φ(n)-1) ≡ 1(mod n)
    所以 a 的 φ(n)-1 次方，是 a 的 模反元素。